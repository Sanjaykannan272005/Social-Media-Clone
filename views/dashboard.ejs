<%- include('partials/header') %>

<div class="container mt-4">
    <div class="row">
        <div class="col-md-3">
            <!-- User profile card -->
            <div class="card mb-4">
                <div class="card-body text-center">
                    <img src="<%= user.avatar || '/images/default-avatar.png' %>" class="rounded-circle mb-3" width="100" height="100" alt="<%= user.username %>">
                    <h5 class="card-title"><%= user.username %></h5>
                    <p class="card-text text-muted"><%= user.email %></p>
                    <div class="d-flex justify-content-center gap-2">
                        <a href="/profile" class="btn btn-outline-primary btn-sm">Edit Profile</a>
                        <a href="/settings" class="btn btn-outline-secondary btn-sm">Settings</a>
                    </div>
                </div>
            </div>
            
            <!-- Navigation -->
            <div class="list-group mb-4">
                <a href="/dashboard" class="list-group-item list-group-item-action active">
                    <i class="fas fa-home me-2"></i> Home
                </a>
                <a href="/posts" class="list-group-item list-group-item-action">
                    <i class="fas fa-newspaper me-2"></i> Posts
                </a>
                <a href="/messages" class="list-group-item list-group-item-action">
                    <i class="fas fa-envelope me-2"></i> Messages
                </a>
                <a href="/profile" class="list-group-item list-group-item-action">
                    <i class="fas fa-user me-2"></i> Profile
                </a>
                <a href="/settings" class="list-group-item list-group-item-action">
                    <i class="fas fa-cog me-2"></i> Settings
                </a>
            </div>
        </div>
        
        <div class="col-md-6">
            <!-- Create post card -->
            <div class="card mb-4">
                <div class="card-body">
                    <h5 class="card-title">Create a post</h5>
                    <form id="postForm" enctype="multipart/form-data">
                        <div class="form-group">
                            <textarea class="form-control" id="postContent" rows="3" placeholder="What's happening?"></textarea>
                        </div>
                        <div class="form-group mt-2">
                            <label for="mediaUpload" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-image"></i> Add Photo/Video
                            </label>
                            <input type="file" id="mediaUpload" name="media" accept="image/*,video/*" style="display: none;">
                            <span id="mediaFileName" class="ml-2"></span>
                        </div>
                        <div id="mediaPreview" class="mt-2" style="display: none;">
                            <img id="imagePreview" class="img-fluid rounded" style="max-height: 200px; display: none;">
                            <video id="videoPreview" class="img-fluid rounded" controls style="max-height: 200px; display: none;"></video>
                            <button type="button" class="btn btn-sm btn-danger mt-1" id="removeMedia">Remove</button>
                        </div>
                        <button type="submit" class="btn btn-primary mt-3">Post</button>
                    </form>
                </div>
            </div>
            
            <!-- Feed -->
            <div id="feed">
                <div class="text-center" id="loadingFeed">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="col-md-3">
            <!-- Search Users -->
            <div class="card mb-4">
                <div class="card-header">
                    Search Users
                </div>
                <div class="card-body">
                    <div class="search-container">
                    <div class="input-group">
                        <span class="input-group-text bg-white">
                            <i class="fas fa-search text-muted"></i>
                        </span>
                        <input type="text" id="userSearchInput" class="form-control border-start-0" placeholder="Search by username...">
                    </div>
                    <span class="clear-search" id="clearSearch"><i class="fas fa-times"></i></span>
                </div>
                    <div id="searchResults" class="mt-2" style="max-height: 300px; overflow-y: auto;">
                        <!-- Search results will appear here -->
                    </div>
                </div>
            </div>
            
            <!-- Suggestions -->
            <div class="card mb-4">
                <div class="card-header">
                    Who to follow
                </div>
                <div class="card-body p-0">
                    <div id="suggestedUsers">
                        <div class="text-center py-3">
                            <div class="spinner-border spinner-border-sm text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Edit Post Modal -->
<div class="modal fade" id="editPostModal" tabindex="-1" aria-labelledby="editPostModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="editPostModalLabel">Edit Post</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <form id="editPostForm">
                    <div class="mb-3">
                        <textarea class="form-control" id="editPostContent" rows="4" required></textarea>
                    </div>
                    <div class="text-end">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                        <button type="submit" class="btn btn-primary">Save changes</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<script src="/js/dashboard.js"></script>
<script src="/js/search.js"></script>
<script src="/js/suggestions.js"></script>
</body>
</html>